?tableone
??tableone
library(tableone)
install.packages("tableone")
library(phonto)    # Epiconnector tools for reproducible NHANES access
library(nhanesA)   # Interface to NHANES public datasets
library(survey)    # Complex survey analysis
library(dplyr)     # Data wrangling
library(tidyr)     # Data wrangling
# --- Keep lists by *names*, minimal set for analysis ---
# DEMO: exact 12 variables (C and D)
DEMO_keep <- c("SEQN","SDDSRVYR","RIDSTATR","RIDEXMON","RIAGENDR","RIDAGEYR",
"RIDAGEMN","RIDAGEEX","WTINT2YR","WTMEC2YR","SDMVPSU","SDMVSTRA")
# BPX: only what's needed for analysis + manual averages for 2005–06 if missing
BPX_keep <- c(
"SEQN",
"BPXSAR","BPXDAR",          # precomputed (present in 2003–04; may be NA in 2005–06)
"BPXSY1","BPXSY2","BPXSY3","BPXSY4",  # raw systolic repeats
"BPXDI1","BPXDI2","BPXDI3","BPXDI4"   # raw diastolic repeats
)
BPX_keep_D <- setdiff(BPX_keep, c("BPXSAR","BPXDAR"))
# BMX: SEQN + BMI (C and D)
BMX_keep <- c("SEQN","BMXBMI")
# DR1TOT: keep only what we actually use
# - WTDRD1: dietary day 1 weight (textbook uses this, then /2 for four-year)
# - DR1TSODI, DR1TPOTA: sodium & potassium (mg/day)
DR1TOT_keep <- c("SEQN","WTDRD1","DR1TSODI","DR1TPOTA")
# For downstream checks
DIET_named_vars <- c("DR1TSODI","DR1TPOTA")
# ---- jointQuery() column map (follow quick_start line ~224 pattern) ----
cols_c <- list(DEMO_C = DEMO_keep,
BPX_C = BPX_keep,
BMX_C = BMX_keep,
DR1TOT_C = DR1TOT_keep)
cols_d <- list(DEMO_D = DEMO_keep,
BPX_D = BPX_keep_D,
BMX_D = BMX_keep,
DR1TOT_D = DR1TOT_keep)
# Will then use：
# data <- jointQuery(cols)
# Cycle C (2003–2004): pull and merge with jointQuery
nhanes34 <- jointQuery(cols_c)
